extends layout

block content

  h1 #{title}

  //- 显示当前数据统计
  if wordCount !== undefined
    .alert.alert-info
      strong 当前数据库中共有 #{wordCount} 个单词

  //- 上传文件表单
  .card.mb-4
    .card-header(style='padding-top: 20px')
      h5 上传单词数据（新增，不覆盖原数据）
    .card-body
      form(method='POST' action='/view/wordCategoryUpload' enctype='multipart/form-data')
        div.form-group
          label(for='file') 选择 Excel 文件:
          input#file.form-control(
            type='file', 
            name='file', 
            accept='.xlsx,.xls',
            required
          )
          small.form-text.text-muted
            | 支持的文件格式: .xlsx, .xls
        div.form-group
          label(for='headerRows', style='margin-top: 20px') 表头行数:
          input#headerRows.form-control(
            type='number', 
            name='headerRows', 
            min='0',
            max='10',
            value='2',
            placeholder='请输入表头行数'
          )
          small.form-text.text-muted
            | 文件开头需要跳过的表头行数，默认为2行
        button.btn.btn-primary(type='submit', style='margin-top: 20px') 上传文件

  //- 删除所有数据表单
  .card
    .card-header(style='padding-top: 20px')
      h5.text-danger 删除所有单词分类
    .card-body
      p.text-muted 此操作将永久删除所有单词分类的数据，且不可恢复！
      form(method='POST' action='/view/wordCategoryDelete')
        .form-group
          label.text-danger 确认删除所有单词分类？
        button.btn.btn-danger(type='submit') 
          i.fas.fa-trash()
          | 确认删除

  if success
    div.alert.alert-success(style='margin-top: 20px')
      strong 上传成功!
      p #{success}

  if errors
    div.alert.alert-danger(style='margin-top: 20px')
      strong 上传过程中出现错误:
      ul
        for error in errors
          li!= error.msg

  if warnings && warnings.length > 0
    div.alert.alert-warning(style='margin-top: 20px')
      strong 警告:
      ul
        for warning in warnings
          li!= warning

  //- 显示预览区域（可选）
  if previewData
    div(style='margin-top: 20px')
      h3 数据预览 (前5行)
      table.table.table-striped
        thead
          tr
            each header in previewData.headers
              th= header
        tbody
          each row in previewData.rows
            tr
              each cell in row
                td= cell
